<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FWM Bets â€“ Parlay Calculator</title>
  <link rel="icon" type="image/png" href="fwm_bets_logo_favicon.png" />

  <!-- PWA Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="fwm_bets_logo_favicon.png">
  <link rel="apple-touch-icon" sizes="152x152" href="fwm_bets_logo_favicon.png">
  <link rel="apple-touch-icon" sizes="120x120" href="fwm_bets_logo_favicon.png">
  <link rel="apple-touch-icon" sizes="76x76" href="fwm_bets_logo_favicon.png">

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#00FF85">

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    /* (STYLE BLOCK UNCHANGED â€” SAME AS YOU SENT) */
  </style>
</head>
<body>
  <div class="app">

    <!-- HEADER -->
    <div class="header">
      <img class="brand-logo" src="fwm_bets_logo_transparent.png" alt="FWM Bets Logo" />
      <div class="cta-chip" onclick="window.open('https://whop.com/fwm-bets/', '_blank')">
        <span class="icon">ðŸ‘¾</span>
        <span>Join for FREE Access</span>
      </div>
    </div>

    <div class="title-group">
      <h1>
        Parlay Calculator
        <span class="badge-live">v1 â€¢ beta</span>
      </h1>
      <div class="subtitle">
        Build parlays, size bets with
        <span style="color: var(--accent);">Light / Regular / Max</span> stakes.
      </div>
    </div>

    <!-- BANKROLL SECTION -->
    <div class="section">
      <div class="section-header">
        <div class="section-title">1. Bankroll Input</div>
      </div>

      <label for="bankroll">Active Bankroll</label>
      <div class="input-row">
        <div class="input-prefix">$</div>
        <input id="bankroll" type="number" min="0" step="1" />
      </div>
    </div>

    <!-- LEGS SECTION -->
    <div class="section">
      <div class="section-header">
        <div class="section-title">2. Parlay Builder</div>
      </div>

      <div class="legs-container" id="legs-container"></div>

      <div class="btn-row" style="margin-top:10px;">
        <button type="button" id="add-leg-btn">âž• Add Leg</button>
        <button type="button" onclick="resetParlay()" class="secondary">Reset</button>
      </div>
    </div>

    <!-- STAKE RESULTS -->
    <div class="section">
      <div class="section-header">
        <div class="section-title">3. Stake & Results</div>
      </div>

      <label for="stake">Parlay Stake</label>
      <div class="input-row" style="margin-bottom:10px;">
        <div class="input-prefix">$</div>
        <input id="stake" type="number" min="0" step="1" />
      </div>

      <div class="summary-row" style="margin-bottom:8px;">
        <div class="summary-main">Parlay odds:
          <span class="value" id="parlay-odds-display">N/A</span>
        </div>
        <div class="summary-main">Potential return:
          <span class="value" id="parlay-return-display">$0.00</span>
        </div>
      </div>

      <div class="summary-row">
        <div class="summary-main">Profit:
          <span class="value" id="parlay-profit-display">$0.00</span>
        </div>
        <div class="summary-badge warn" id="stake-risk-status">
          Enter bankroll & stake
        </div>
      </div>
    </div>

    <!-- NOTES -->
    <div class="section">
      <div class="notes">
        <div class="notes-title">Notes</div>
        <ul>
          <li><strong>Odds Input</strong>: American only (+120, -150, etc.)</li>
        </ul>
      </div>
    </div>

<script>

  // DOM REFS
  const bankrollInput = document.getElementById('bankroll');
  const stakeInput = document.getElementById('stake');
  const parlayOddsDisplay = document.getElementById('parlay-odds-display');
  const parlayReturnDisplay = document.getElementById('parlay-return-display');
  const parlayProfitDisplay = document.getElementById('parlay-profit-display');
  const stakeRiskStatusEl = document.getElementById('stake-risk-status');
  const legsContainer = document.getElementById('legs-container');
  const addLegBtn = document.getElementById('add-leg-btn');

  // Helpers
  const parseBankroll = () => Number(bankrollInput.value) || 0;
  const parseStake = () => Number(stakeInput.value) || 0;
  const fmtCurrency = (x) => '$' + x.toFixed(2);

  function parseAmericanOdds(val) {
    const v = parseInt(val);
    if (!val || isNaN(v)) return null;
    return v;
  }

  function americanToDecimal(american) {
    return american > 0
      ? 1 + american/100
      : 1 + 100/Math.abs(american);
  }

  // Legs
  function addLeg() {
    const card = document.createElement('div');
    card.className = 'leg-card';
    card.innerHTML = `
      <div class="leg-card-inner">
        <div class="leg-header-row">
          <span class="leg-index">Leg ${legsContainer.children.length+1}</span>
          <button type="button" class="remove-leg">Remove</button>
        </div>
        <input type="text" class="leg-label-input" placeholder="Describe leg" />
        <input type="number" class="leg-odds" placeholder="-110" step="1"/>
      </div>
    `;
    card.querySelector('.remove-leg')
      .addEventListener('click', () => {
        card.remove();
        renumber();
        recalc();
      });
    card.querySelector('.leg-odds')
      .addEventListener('input', recalc);
    legsContainer.appendChild(card);
  }

  function renumber() {
    [...legsContainer.children].forEach((c,i)=>
      c.querySelector('.leg-index').textContent = 'Leg ' + (i+1)
    );
  }

  // Calculations
  function recalc() {
    let combinedDecimal = 1;
    let valid = 0;

    [...legsContainer.querySelectorAll('.leg-odds')].forEach(input=>{
      const american = parseAmericanOdds(input.value);
      if (american!==null) {
        combinedDecimal *= americanToDecimal(american);
        valid++;
      }
    });

    if (!valid) {
      parlayOddsDisplay.textContent = 'N/A';
      parlayReturnDisplay.textContent = '$0.00';
      parlayProfitDisplay.textContent = '$0.00';
      stakeRiskStatusEl.textContent = 'Enter bankroll & stake';
      return;
    }

    const decimal = combinedDecimal;
    const american = (decimal >=2)
      ? Math.round((decimal-1)*100)
      : Math.round(-100/(decimal-1));

    parlayOddsDisplay.textContent = `${american>0?'+':''}${american}`;

    const stake = parseStake();
    if (!stake) {
      parlayReturnDisplay.textContent = '$0.00';
      parlayProfitDisplay.textContent = '$0.00';
    } else {
      const payout = stake*decimal;
      parlayReturnDisplay.textContent = fmtCurrency(payout);
      parlayProfitDisplay.textContent = fmtCurrency(payout-stake);
    }

    updateRisk();
  }

  function updateRisk() {
    const br = parseBankroll();
    const st = parseStake();
    stakeRiskStatusEl.classList.remove('safe','warn','danger');

    if (!br || !st) {
      stakeRiskStatusEl.textContent = 'Enter bankroll & stake';
      stakeRiskStatusEl.classList.add('warn');
      return;
    }

    const pct = (st/br)*100;

    if (pct <=5) {
      stakeRiskStatusEl.textContent='ðŸŸ¢ Conservative';
      stakeRiskStatusEl.classList.add('safe');
    }
    else if (pct<=12) {
      stakeRiskStatusEl.textContent='âš ï¸ High risk';
      stakeRiskStatusEl.classList.add('warn');
    }
    else {
      stakeRiskStatusEl.textContent='ðŸš¨ Overexposed';
      stakeRiskStatusEl.classList.add('danger');
    }
  }

  // Reset
  function resetParlay() {
    bankrollInput.value='';
    stakeInput.value='';
    parlayOddsDisplay.textContent='N/A';
    parlayReturnDisplay.textContent='$0.00';
    parlayProfitDisplay.textContent='$0.00';
    stakeRiskStatusEl.textContent='Enter bankroll & stake';
    stakeRiskStatusEl.className='summary-badge warn';
    legsContainer.innerHTML='';
    addLeg();
  }

  // EVENTS
  bankrollInput.addEventListener('input', recalc);
  stakeInput.addEventListener('input', recalc);
  addLegBtn.addEventListener('click', ()=>{addLeg(); recalc();});

  // INIT
  addLeg();
  recalc();

</script>
</body>
</html>
